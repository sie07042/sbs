# ==========================================
# Docker Compose: React 프론트엔드 로컬 테스트 환경
# ==========================================
# 이 파일은 백엔드와 mysql-8이 이미 실행 중인 상태에서
# 프론트엔드만 Docker 컨테이너로 실행하기 위한 설정입니다.

version: '3.8'

services:
  # ==========================================
  # 프론트엔드 서비스 (React + Nginx)
  # ==========================================
  frontend:
    # 컨테이너 이름
    container_name: sbs-frontend

    # Dockerfile을 사용한 이미지 빌드
    build:
      context: .
      dockerfile: Dockerfile

    # 포트 매핑: 호스트의 80번 포트를 컨테이너의 80번 포트로 연결
    # http://localhost:80 으로 접속 가능
    ports:
      - "80:80"

    # 네트워크 설정: 백엔드와 같은 bridge 네트워크 사용
    # 이렇게 하면 기존 백엔드 컨테이너와 통신 가능
    network_mode: bridge

    # 외부 컨테이너 연결
    # mysql-8과 백엔드 컨테이너가 이미 실행 중이라고 가정
    external_links:
      - mysql-8

    # 환경 변수 (필요시 추가)
    # environment:
    #   - NODE_ENV=production
    #   - API_URL=http://host.docker.internal:9080

    # 재시작 정책
    restart: unless-stopped

    # 헬스 체크 (선택 사항)
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

# ==========================================
# 네트워크 설정 (선택 사항)
# ==========================================
# bridge 네트워크를 사용하므로 별도 정의 불필요
# 필요시 사용자 정의 네트워크 생성 가능:
# networks:
#   app-network:
#     driver: bridge
